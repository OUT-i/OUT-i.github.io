<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Página inspirada en estética punk con glitch y fondo reactivo.">
  <title>El nadador fuerte</title>

  <style>
    :root {
      --bg: #000;
      --text: rgba(255,255,255,0.95);
      --accent: #00ff77; /* Verde claro */
      --text-bg-opacity: 0.65; /* Ajusta la opacidad del cuadro de texto */
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body {
      height: 100%;
      width: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: 'Courier New', monospace;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2vw;
    }

    /* Fondo con movimiento reactivo */
    .bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      background: url('images/1.jpg') center/cover no-repeat;
      filter: grayscale(100%) contrast(250%) brightness(120%);
      image-rendering: pixelated;
      transition: transform 0.15s linear;
      will-change: transform;
    }

    /* Efecto de dithering visual sutil */
    .bg::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        repeating-linear-gradient(45deg, rgba(255,255,255,0.05) 0px, rgba(255,255,255,0.05) 1px, transparent 1px, transparent 2px),
        repeating-linear-gradient(-45deg, rgba(255,255,255,0.05) 0px, rgba(255,255,255,0.05) 1px, transparent 1px, transparent 2px);
      background-size: 2px 2px;
      mix-blend-mode: difference;
      opacity: 0.25;
      pointer-events: none;
    }

    /* Cuadro de texto principal */
    main {
      position: relative;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      width: min(90vw, 680px);
      max-height: 80vh;
      background: rgba(0, 0, 0, var(--text-bg-opacity));
      border: 1.5px solid rgba(255,255,255,0.12);
      box-shadow: 0 0 15px rgba(0,255,100,0.2), 0 0 40px rgba(0,0,0,1);
      text-align: left;
      padding: clamp(16px, 5vw, 40px);
      border-radius: 10px;
      overflow-y: auto;
      transition: background 0.25s ease, transform 0.15s ease;
      backdrop-filter: blur(3px);
    }

    p {
      font-size: clamp(15px, 3.5vw, 20px);
      line-height: 1.45;
      letter-spacing: 0.02em;
      text-shadow: 0 0 6px rgba(0,255,100,0.25), 0 0 10px rgba(255,255,255,0.15);
      position: relative;
      z-index: 3;
    }

    /* Ruido verde sutil */
    .noise {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 3;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="1.2" numOctaves="2"/></filter><rect width="100%" height="100%" filter="url(%23n)" fill="%2300ff77" opacity="0.05"/></svg>');
      mix-blend-mode: overlay;
      animation: noise 0.4s infinite steps(2, end);
      opacity: 0.3;
    }

    @keyframes noise {
      0% { transform: translate(0,0); }
      50% { transform: translate(-1px,1px); }
      100% { transform: translate(1px,-1px); }
    }

    /* Adaptación móvil */
    @media (max-width: 600px) {
      main {
        width: 92vw;
        max-height: 85vh;
        padding: 6vw;
        border-radius: 8px;
      }
      p {
        font-size: clamp(14px, 4.2vw, 18px);
      }
    }

  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="noise"></div>

  <main id="textBox">
    <p>
      El nadador fuerte, que conoce la costa, puede aventurarse con relativa seguridad.
      El no nadador, que no toma consejo sino de sus propios impulsos, puede pagar su temeridad con su vida.
      Pero no debemos cometer el error de pensar que estas fuerzas invisibles son necesariamente malas y enemigas de la humanidad.
      No son más enemigas en sí mismas que lo son el agua o el fuego, pero son potentes.
    </p>
  </main>

  <script>
    const bg = document.querySelector('.bg');
    const textBox = document.getElementById('textBox');

    document.addEventListener('mousemove', (e) => {
      const x = (e.clientX / window.innerWidth - 0.5) * 40;
      const y = (e.clientY / window.innerHeight - 0.5) * 40;

      // Movimiento reactivo del fondo
      bg.style.transform = `translate(${x}px, ${y}px) scale(1.05)`;

      // Vibración sutil del cuadro
      const subtleX = x * 0.05;
      const subtleY = y * 0.05;
      textBox.style.transform = `translate(${subtleX}px, ${subtleY}px)`;
    });

    // Centrado al cambiar tamaño de ventana
    window.addEventListener('resize', () => {
      textBox.style.transform = 'translate(0,0)';
    });
  </script>
</body>
</html>

      transition:transform 60ms linear;
      -webkit-filter: none; /* let SVG filter handle displacement */
      filter: url('#dither') contrast(350%) brightness(110%) grayscale(100%);
    }

    /* duplicated layers for chromatic/glitch offsets */
    .glitch-layer{
      position:absolute;inset:-10% -10% -10% -10%;
      background-image: url('images/1.jpg');
      background-size:cover;background-position:center;
      image-rendering: pixelated;
      mix-blend-mode:screen; /* will be colored */
      opacity:0.65;pointer-events:none;transition:transform 50ms linear;
      filter: url('#dither') contrast(450%) brightness(120%) grayscale(100%);
    }

    /* green flash overlay (tinted glitch) */
    .glow-green{
      position:absolute;inset:-15% -15% -15% -15%;
      background-image: url('images/1.jpg');
      background-size:cover;background-position:center;
      mix-blend-mode:screen;opacity:0;pointer-events:none;transition:opacity 120ms linear, transform 120ms linear;
      filter: url('#dither') contrast(500%) brightness(140%) grayscale(100%) drop-shadow(0 0 8px rgba(var(--green),0.2));
      background-color: rgba(var(--green),0.04);
    }

    /* heavy posterized mask to fake dithering/pixel blocks */
    .pixel-mask{position:absolute;inset:-10% -10% -10% -10%;background-image: repeating-linear-gradient(0deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 4px), repeating-linear-gradient(90deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 4px);mix-blend-mode:overlay;opacity:0.6;pointer-events:none}

    /* center content box */
    main{
      position:relative;z-index:6;display:flex;align-items:center;justify-content:center;max-width:90vw;width:90vw;max-height:80vh;height:80vh;padding:4vw;background:rgba(0,0,0,0.55);border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 40px rgba(0,0,0,0.8), 0 0 30px rgba(0,0,0,0.8);backdrop-filter:blur(6px);
    }

    p{color:#fff;font-size:clamp(15px,3.6vw,20px);line-height:1.45;max-width:86%;text-align:left;position:relative;z-index:8;pointer-events:none;text-shadow:0 6px 24px rgba(0,0,0,0.8)}

    /* subtle text reaction */
    .txt-move{transform:translate3d(calc(var(--mx) * 4px), calc(var(--my) * 4px), 0);transition:transform 120ms linear}

    /* clip glitch slices */
    .slice{position:absolute;left:0;right:0;height:6%;background:transparent;pointer-events:none}

    /* several slices positioned randomly in DOM; JS will set transforms */

    /* ensure performance */
    .bg, .glitch-layer, .glow-green, .pixel-mask{will-change:transform,opacity,filter}

    /* small screens more square layout */
    @media(min-width:700px){main{width:min(70vw,900px);height:auto;aspect-ratio:4/3}}

  </style>

  <!-- SVG filters: displacement (ditherish), posterize and threshold -->
  <svg width="0" height="0" style="position:absolute">
    <filter id="dither" x="-20%" y="-20%" width="140%" height="140%">
      <!-- noise-based turbulence for dither texture -->
      <feTurbulence id="turb" type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch" result="noise"/>
      <!-- small blur to soften -->
      <feGaussianBlur in="noise" stdDeviation="0.6" result="nblur"/>
      <!-- displacement driven by noise; scale will be updated by JS for violent effect -->
      <feDisplacementMap id="disp" in="SourceGraphic" in2="nblur" scale="20" xChannelSelector="R" yChannelSelector="G" result="displaced"/>
      <!-- enhance contrast / posterize to create harsh B/W -->
      <feComponentTransfer in="displaced" result="poster">
        <feFuncR type="table" tableValues="0 0 1 1"/>
        <feFuncG type="table" tableValues="0 0 1 1"/>
        <feFuncB type="table" tableValues="0 0 1 1"/>
      </feComponentTransfer>
      <!-- add strong contrast -->
      <feColorMatrix in="poster" type="matrix" values="3 0 0 0 -1  0 3 0 0 -1  0 0 3 0 -1  0 0 0 1 0" result="highc"/>
      <!-- merge with original for more depth (keeps some midtones) -->
      <feBlend in="SourceGraphic" in2="highc" mode="screen"/>
    </filter>
  </svg>
</head>
<body>
  <div class="stage" aria-hidden="true">
    <div class="bg" id="bg"></div>
    <div class="glitch-layer" id="g1" style="mix-blend-mode:screen;filter: url('#dither');opacity:0.6;background-position:50% 50%;"></div>
    <div class="glitch-layer" id="g2" style="mix-blend-mode:difference;opacity:0.45;filter: url('#dither');background-position:50% 50%;"></div>
    <div class="glow-green" id="green"></div>
    <div class="pixel-mask" id="mask"></div>
    <!-- slices for sharper horizontal glitches -->
    <div class="slice" id="s1" style="top:12%"></div>
    <div class="slice" id="s2" style="top:28%"></div>
    <div class="slice" id="s3" style="top:44%"></div>
    <div class="slice" id="s4" style="top:60%"></div>
    <div class="slice" id="s5" style="top:76%"></div>
  </div>

  <main>
    <p class="txt-move" id="copy">El nadador fuerte, que conoce la costa, puede aventurarse con relativa seguridad. El no nadador, que no toma consejo sino de sus propios impulsos, puede pagar su temeridad con su vida. Pero no debemos cometer el error de pensar que estas fuerzas invisibles son necesariamente malas y enemigas de la humanidad. No son más enemigas en sí mismas que lo son el agua o el fuego, pero son potentes.</p>
  </main>

  <script>
    // Elements
    const bg = document.getElementById('bg');
    const g1 = document.getElementById('g1');
    const g2 = document.getElementById('g2');
    const green = document.getElementById('green');
    const mask = document.getElementById('mask');
    const copy = document.getElementById('copy');
    const turb = document.getElementById('turb');
    const disp = document.getElementById('disp');
    const slices = [document.getElementById('s1'),document.getElementById('s2'),document.getElementById('s3'),document.getElementById('s4'),document.getElementById('s5')];

    // ensure background images update with same source
    const src = 'images/1.jpg';
    [bg,g1,g2,green].forEach(el => el.style.backgroundImage = `url('${src}')`);

    // violent response parameters
    const maxShift = 40; // px max shift for layers
    const maxDispScale = 120; // SVG displacement scale max
    let lastMove = Date.now();
    let greenTimeout = null;

    // helper: clamp
    const clamp = (v,a,b) => Math.max(a,Math.min(b,v));

    // update on mouse/touch move
    function handleMove(clientX, clientY){
      const w = window.innerWidth; const h = window.innerHeight;
      // normalized -1 .. 1
      const nx = (clientX / w) * 2 - 1;
      const ny = (clientY / h) * 2 - 1;

      // intensity grows with distance from center
      const intensity = Math.sqrt(nx*nx + ny*ny);

      // violent mapping
      const shiftX = Math.round(nx * maxShift * (0.8 + intensity));
      const shiftY = Math.round(ny * maxShift * (0.8 + intensity));

      // apply transforms (several layers with different multipliers)
      bg.style.transform = `translate3d(${shiftX/3}px, ${shiftY/3}px, 0) scale(1.02)`;
      g1.style.transform = `translate3d(${shiftX * 0.9}px, ${-shiftY * 0.4}px, 0) rotate(${nx*2}deg)`;
      g2.style.transform = `translate3d(${-shiftX * 0.6}px, ${shiftY * 0.7}px, 0) rotate(${ny*3}deg)`;

      // update SVG displacement scale based on intensity and randomness for violent feel
      const scale = Math.round(clamp((intensity * maxDispScale) + (Math.random()*20 - 10), 8, maxDispScale));
      disp.setAttribute('scale', String(scale));
      // subtle change to baseFrequency for noise 'grain' jitter
      const bf = clamp(0.6 + intensity * 1.2 + (Math.random()*0.2 - 0.1), 0.3, 1.6);
      turb.setAttribute('baseFrequency', String(bf));

      // update slices (horizontal torn strips)
      slices.forEach((s, i) => {
        const hShift = Math.round((Math.random()*2 - 1) * shiftX * (0.5 + i*0.2));
        s.style.transform = `translate3d(${hShift}px, 0, 0)`;
        s.style.backgroundImage = `linear-gradient(90deg, rgba(0,0,0,0.0) 0%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.0) 100%), url('${src}')`;
        s.style.backgroundSize = 'cover';
        s.style.backgroundPosition = 'center';
        s.style.mixBlendMode = i % 2 === 0 ? 'screen' : 'difference';
        s.style.opacity = 0.55 + Math.random()*0.25;
      });

      // small text movement
      copy.style.transform = `translate3d(${nx*4}px, ${ny*4}px, 0)`;

      // green flash on intense moves
      if(intensity > 0.35){
        triggerGreenFlash(intensity);
      }

      lastMove = Date.now();
    }

    function triggerGreenFlash(intensity){
      if(greenTimeout) clearTimeout(greenTimeout);
      green.style.opacity = 0.9 * clamp(intensity, 0.3, 1);
      // random slight transform
      green.style.transform = `translate3d(${(Math.random()*2-1)*20}px, ${(Math.random()*2-1)*20}px, 0) scale(${1.02 + Math.random()*0.06})`;
      green.style.filter = `url('#dither') contrast(700%) brightness(160%) grayscale(100%)`;
      greenTimeout = setTimeout(()=>{green.style.opacity = 0;}, 140);
    }

    // subtle idle jitter to keep it alive
    setInterval(()=>{
      const now = Date.now();
      if(now - lastMove > 1200){
        // small breathing
        bg.style.transform = `translate3d(${(Math.random()*2-1)*2}px, ${(Math.random()*2-1)*2}px,0) scale(1.01)`;
        g1.style.transform = `translate3d(${(Math.random()*2-1)*6}px, ${(Math.random()*2-1)*6}px,0)`;
        g2.style.transform = `translate3d(${(Math.random()*2-1)*6}px, ${(Math.random()*2-1)*6}px,0)`;
        disp.setAttribute('scale', String(8 + Math.random()*12));
      }
    }, 350);

    // pointer events
    window.addEventListener('mousemove', e => handleMove(e.clientX, e.clientY));
    window.addEventListener('touchmove', e => { if(e.touches[0]) handleMove(e.touches[0].clientX, e.touches[0].clientY); }, {passive:true});

    // performance: pause intense updates when tab hidden
    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden){
        disp.setAttribute('scale','6');
        bg.style.transform = 'translate3d(0,0,0) scale(1)';
        g1.style.transform = 'translate3d(0,0,0)'; g2.style.transform='translate3d(0,0,0)';
      }
    });

    // accessibility: ensure image exists fallback
    const imgTest = new Image(); imgTest.src = src;
    imgTest.onerror = ()=>{
      console.warn('No se encuentra images/1.jpg — coloca tu imagen en /images/1.jpg para ver el efecto.');
      // fallback: use neutral background
      [bg,g1,g2,green].forEach(el=>el.style.backgroundColor='#111');
    };

  </script>
</body>
</html>




